<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.indo.game.mapper.SysChessBalanceMapper">
  <resultMap id="BaseResultMap" type="com.indo.game.pojo.entity.SysChessBalance">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="chess_code" jdbcType="VARCHAR" property="chessCode" />
    <result column="chess_name" jdbcType="VARCHAR" property="chessName" />
    <result column="chess_balance" jdbcType="DECIMAL" property="chessBalance" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="update_user" jdbcType="VARCHAR" property="updateUser" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="is_delete" jdbcType="BIT" property="isDelete" />
  </resultMap>
  <!--ROUND 是为了防止金额精度损失  比如 数字1 ，记录为0.9999999... -->
  <update id="addBalance">
    update sys_chess_balance
    set chess_balance = ROUND(chess_balance + ${balance} ,3)
    where chess_code = #{chessCode} and is_delete = b'0'
  </update>

  <update id="subtractBalance">
    update sys_chess_balance
    <!-- set chess_balance = ROUND( IF((chess_balance - ${balance}) > 0 , chess_balance - ${balance} , 0) , 3)-->
    set chess_balance = ROUND( chess_balance - ${balance} , 3)
    where chess_code = #{chessCode} and is_delete = b'0'
    and chess_balance >= ${balance}
  </update>
</mapper>